module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},38847,a=>{"use strict";let b=process.env.NEXT_PUBLIC_API_URL??"http://localhost:3000";a.s(["BASE_URL",0,b])},44750,a=>{"use strict";var b=a.i(72131),c=a.i(50944);a.i(47033),a.s(["useRequireAuth",0,a=>{let d=(0,c.useRouter)(),[e,f]=(0,b.useState)(null);return(0,b.useEffect)(()=>{},[a?.allowedRoles,d]),e}])},76254,a=>{"use strict";var b=a.i(72131),c=a.i(50944),d=a.i(47033),e=a.i(38847),f=a.i(44750);let g=a=>a.toLocaleDateString("vi-VN",{weekday:"long",day:"2-digit",month:"long",year:"numeric"}),h=a=>new Date(a).toLocaleString("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}),i=a=>{if(null==a)return"0h";let b="string"==typeof a?parseFloat(a):a;return Number.isNaN(b)?"0h":`${b.toFixed(2)}h`},j={display:"flex",flexDirection:"column",gap:"12px",alignItems:"flex-end"},k=(0,b.memo)(({attendance:a})=>(0,b.createElement)("tr",null,(0,b.createElement)("td",null,g(new Date(a.workDate))),(0,b.createElement)("td",null,a.checkInTime?h(a.checkInTime):"--"),(0,b.createElement)("td",null,a.checkOutTime?h(a.checkOutTime):"--"),(0,b.createElement)("td",null,i(a.totalHours)),(0,b.createElement)("td",null,(0,b.createElement)("span",{className:`ritzy-badge ${a.status}`},a.status))));k.displayName="HistoryRow",a.s(["default",0,()=>{let a=(0,c.useRouter)(),l=(0,f.useRequireAuth)(),[m,n]=(0,b.useState)(()=>new Date),[o,p]=(0,b.useState)(()=>new Date),q=(0,b.useRef)(new Date().toDateString()),[r,s]=(0,b.useState)(null),[t,u]=(0,b.useState)([]),[v,w]=(0,b.useState)(!1),[x,y]=(0,b.useState)(!1),[z,A]=(0,b.useState)(!1),[B,C]=(0,b.useState)(!1),[D,E]=(0,b.useState)(null),F=(0,b.useRef)(null),G=(0,b.useMemo)(()=>m.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}),[m]),H=(0,b.useMemo)(()=>g(o),[o]),I=(0,b.useCallback)(a=>{F.current&&(window.clearTimeout(F.current),F.current=null),E(a),a&&(F.current=window.setTimeout(()=>{E(null),F.current=null},3200))},[]);(0,b.useEffect)(()=>()=>{F.current&&window.clearTimeout(F.current)},[]),(0,b.useEffect)(()=>{let a=window.setInterval(()=>{let a=new Date;n(a);let b=a.toDateString();b!==q.current&&(q.current=b,p(a))},6e4);return()=>window.clearInterval(a)},[]),(0,b.useEffect)(()=>{l||a.replace("/login")},[l,a]);let J=(0,b.useCallback)(async()=>{if(l){w(!0);try{let a=await fetch(`${e.BASE_URL}/api/attendance/today`,{headers:{...d.authUtils.getAuthHeader(),"Content-Type":"application/json"}});if(!a.ok)return;let b=await a.json();s(b.data??null)}catch(a){console.error("Error fetching today attendance:",a)}finally{w(!1)}}},[l]),K=(0,b.useCallback)(async()=>{if(l){y(!0);try{let a=await fetch(`${e.BASE_URL}/api/attendance/history?limit=10`,{headers:{...d.authUtils.getAuthHeader(),"Content-Type":"application/json"}});if(!a.ok)return;let b=await a.json();u(b.data??[])}catch(a){console.error("Error fetching attendance history:",a)}finally{y(!1)}}},[l]);(0,b.useEffect)(()=>{l&&J()},[l,J]),(0,b.useEffect)(()=>{B&&l&&K()},[B,l,K]);let L=(0,b.useCallback)(()=>{d.authUtils.clearAuth(),a.replace("/login")},[a]),M=(0,b.useCallback)(async()=>{if(!l||r)return void I({type:"error",text:"Bạn đã chấm công vào hôm nay rồi"});A(!0);try{let a=await fetch(`${e.BASE_URL}/api/attendance/checkin`,{method:"POST",headers:{...d.authUtils.getAuthHeader(),"Content-Type":"application/json"},body:JSON.stringify({})}),b=await a.json().catch(()=>null);if(!a.ok)throw Error(b?.message??"Không thể chấm công vào");I({type:"success",text:"Chấm công vào thành công!"}),await J(),B&&await K()}catch(a){I({type:"error",text:a instanceof Error?a.message:"Đã xảy ra lỗi khi chấm công vào"})}finally{A(!1)}},[l,r,I,J,K,B]),N=(0,b.useCallback)(async()=>{if(l){if(!r)return void I({type:"error",text:"Bạn chưa chấm công vào hôm nay"});if(r.checkOutTime)return void I({type:"error",text:"Bạn đã chấm công ra hôm nay rồi"});A(!0);try{let a=await fetch(`${e.BASE_URL}/api/attendance/checkout`,{method:"POST",headers:{...d.authUtils.getAuthHeader(),"Content-Type":"application/json"},body:JSON.stringify({})}),b=await a.json().catch(()=>null);if(!a.ok)throw Error(b?.message??"Không thể chấm công ra");I({type:"success",text:"Chấm công ra thành công!"}),await J(),B&&await K()}catch(a){I({type:"error",text:a instanceof Error?a.message:"Đã xảy ra lỗi khi chấm công"})}finally{A(!1)}}},[l,r,I,J,K,B]),O=(0,b.useCallback)(()=>{C(a=>!a)},[]),P=(0,b.useMemo)(()=>[{label:"Check-in",value:r?.checkInTime?h(r.checkInTime):"--/--"},{label:"Check-out",value:r?.checkOutTime?h(r.checkOutTime):"--/--"},{label:"Tổng giờ",value:i(r?.totalHours)},{label:"Ngày làm",value:H}],[r,H]);return(0,b.createElement)("div",{className:"ritzy-dashboard"},(0,b.createElement)("div",{className:"ritzy-shell"},(0,b.createElement)("header",{className:"ritzy-top-bar"},(0,b.createElement)("div",null,(0,b.createElement)("p",{className:"ritzy-brand"},"Chấm công Bình Boong"),(0,b.createElement)("p",{className:"ritzy-subtitle"},"Một ngày làm việc vui vẻ hoặc không"),l?(0,b.createElement)("p",{className:"ritzy-greeting"},"Xin chào, ",l.fullName??l.username):null),(0,b.createElement)("div",{style:j},(0,b.createElement)("span",{className:"ritzy-calendar-chip"},H),(0,b.createElement)("button",{className:"ritzy-btn",onClick:L},"Đăng xuất"))),D?(0,b.createElement)("div",{className:`ritzy-alert ${D.type}`},D.text):null,(0,b.createElement)("div",{className:"ritzy-content-grid"},(0,b.createElement)("section",{className:"ritzy-hero"},(0,b.createElement)("p",{className:"ritzy-hero-kicker"},"Thời gian hệ thống:"),(0,b.createElement)("div",{className:"ritzy-hero-clock"},G),(0,b.createElement)("p",{className:"ritzy-hero-caption"},"Đồng hồ chấm công"),(0,b.createElement)("div",{className:"ritzy-hero-meta"},(0,b.createElement)("span",null,H),(0,b.createElement)("span",null,r?"Sẵn sàng hoàn tất ngày làm việc":"Đã đến giờ bắt đầu ngày mới"),r?.checkInTime?(0,b.createElement)("span",null,`Đ\xe3 check-in: ${h(r.checkInTime)}`):null)),(0,b.createElement)("section",{className:"ritzy-panel"},(0,b.createElement)("div",{className:"ritzy-panel-header"},(0,b.createElement)("div",null,(0,b.createElement)("p",{className:"ritzy-overline"},"Hôm nay"),(0,b.createElement)("h2",{className:"ritzy-panel-title"},"Trạng thái làm việc"))),v?(0,b.createElement)("p",{className:"ritzy-placeholder"},"Đang tải thông tin hôm nay..."):(0,b.createElement)("div",{className:"user-status-grid"},P.map(a=>(0,b.createElement)("div",{key:a.label,className:"user-status-row"},(0,b.createElement)("span",null,a.label),(0,b.createElement)("strong",null,a.value)))))),(0,b.createElement)("div",{className:"ritzy-grid"},(0,b.createElement)("article",{className:`ritzy-action-card ${r?"disabled":""}`,"aria-disabled":!!r},(0,b.createElement)("h3",null,"Chấm công vào"),(0,b.createElement)("p",null,"Ghi nhận thời điểm bắt đầu làm việc trong ngày."),(0,b.createElement)("button",{className:"ritzy-btn block",onClick:M,disabled:!!r||z},z?"Đang xử lý...":"Chấm công vào")),(0,b.createElement)("article",{className:`ritzy-action-card ${!r||r.checkOutTime?"disabled":""}`,"aria-disabled":!r||!!r?.checkOutTime},(0,b.createElement)("h3",null,"Chấm công ra"),(0,b.createElement)("p",null,"Hoàn tất phiên làm việc và tính tổng giờ."),(0,b.createElement)("button",{className:"ritzy-btn block",onClick:N,disabled:!r||!!r.checkOutTime||z},z?"Đang xử lý...":"Chấm công ra")),(0,b.createElement)("article",{className:"ritzy-action-card"},(0,b.createElement)("h3",null,"Lịch sử chấm công"),(0,b.createElement)("p",null,"Xem 10 bản ghi gần nhất của bạn."),(0,b.createElement)("button",{className:"ritzy-btn ghost block",onClick:O},B?"Thu gọn lịch sử":"Xem lịch sử"))),B?(0,b.createElement)("section",{className:"ritzy-history"},(0,b.createElement)("header",null,(0,b.createElement)("div",null,(0,b.createElement)("p",{className:"ritzy-overline"},"Lịch sử"),(0,b.createElement)("h2",{className:"ritzy-panel-title"},"Nhật ký chấm công")),(0,b.createElement)("span",{className:"ritzy-calendar-chip"},`${t.length} bản ghi`)),x?(0,b.createElement)("p",{className:"ritzy-placeholder"},"Đang tải lịch sử..."):0===t.length?(0,b.createElement)("p",{className:"ritzy-placeholder"},"Bạn chưa có lịch sử chấm công."):(0,b.createElement)("div",{className:"ritzy-table-wrapper"},(0,b.createElement)("table",{className:"ritzy-history-table"},(0,b.createElement)("thead",null,(0,b.createElement)("tr",null,(0,b.createElement)("th",null,"Ngày"),(0,b.createElement)("th",null,"Check-in"),(0,b.createElement)("th",null,"Check-out"),(0,b.createElement)("th",null,"Tổng giờ"),(0,b.createElement)("th",null,"Trạng thái"))),(0,b.createElement)("tbody",null,t.map(a=>(0,b.createElement)(k,{key:a.id,attendance:a})))))):null))},"dynamic",0,"force-dynamic"])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__04daf1e0._.js.map